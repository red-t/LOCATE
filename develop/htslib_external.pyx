cdef int MAX_POS = (1 << 31) - 1